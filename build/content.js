const o=typeof window<"u"&&window.browser?window.browser:chrome;let n=null,r=null;function a(){r=window.ethereum}function c(){(!r||r!==window.ethereum)&&r&&r.isDevnetWallet&&(window.ethereum=r)}function u(){try{const t=document.createElement("script");t.src=o.runtime.getURL("inject.js"),t.onload=function(){t.remove(),setTimeout(a,50)};const e=document.head||document.documentElement;e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}catch{}}function E(){const t=setInterval(()=>{c()},100);setTimeout(()=>{clearInterval(t)},1e4)}u();setTimeout(E,100);window.addEventListener("message",async t=>{var d;if(t.source!==window)return;const e=t.data;if(!(!e||typeof e!="object")){if(e.type==="DEVNET_WALLET_HANDSHAKE"){typeof e.token=="string"&&e.token.length<=256&&(n=e.token,window.postMessage({type:"DEVNET_WALLET_HANDSHAKE",acknowledged:!0,token:n},"*"));return}if(!(!n||e.token!==n)&&e.type&&e.type.startsWith("DEVNET_WALLET_")&&!e.type.endsWith("_RESPONSE"))try{if(!((d=o.runtime)!=null&&d.id))throw new Error("Extension context invalidated. Please refresh the page.");const i={type:e.type.replace("DEVNET_WALLET_",""),data:e.data},s=await o.runtime.sendMessage(i);window.postMessage({type:e.type+"_RESPONSE",id:e.id,response:s,token:n},"*")}catch(i){let s=i.message;i.message.includes("Extension context invalidated")&&(s="Extension was updated. Please refresh this page to reconnect your wallet."),window.postMessage({type:e.type+"_RESPONSE",id:e.id,response:{success:!1,error:s},token:n},"*")}}});o.runtime.onMessage.addListener(t=>{var e;try{if(!((e=o.runtime)!=null&&e.id))return;if(t.type==="NETWORK_CHANGED"){if(!n)return;window.postMessage({type:"DEVNET_WALLET_NETWORK_CHANGED",network:t.network,token:n},"*")}}catch{}});
