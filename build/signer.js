import{L as d,j as y,a as E,k as U,B as k,l as q,m as C,n as j,h as Z,M as H,O as K,N as Q,Z as X,t as Y,o as ee,J as te,W as re}from"./assets/json-rpc-provider-Bp7nyTct.js";const O="abi/5.7.0",V=new d(O),W={};let D={calldata:!0,memory:!0,storage:!0},se={calldata:!0,memory:!0};function R(i,e){if(i==="bytes"||i==="string"){if(D[e])return!0}else if(i==="address"){if(e==="payable")return!0}else if((i.indexOf("[")>=0||i==="tuple")&&se[e])return!0;return(D[e]||e==="payable")&&V.throwArgumentError("invalid modifier","name",e),!1}function ne(i,e){let t=i;function s(o){V.throwArgumentError(`unexpected character at position ${o}`,"param",i)}i=i.replace(/\s/g," ");function n(o){let l={type:"",name:"",parent:o,state:{allowType:!0}};return e&&(l.indexed=!1),l}let a={type:"",name:"",state:{allowType:!0}},r=a;for(let o=0;o<i.length;o++){let l=i[o];switch(l){case"(":r.state.allowType&&r.type===""?r.type="tuple":r.state.allowParams||s(o),r.state.allowType=!1,r.type=b(r.type),r.components=[n(r)],r=r.components[0];break;case")":delete r.state,r.name==="indexed"&&(e||s(o),r.indexed=!0,r.name=""),R(r.type,r.name)&&(r.name=""),r.type=b(r.type);let u=r;r=r.parent,r||s(o),delete u.parent,r.state.allowParams=!1,r.state.allowName=!0,r.state.allowArray=!0;break;case",":delete r.state,r.name==="indexed"&&(e||s(o),r.indexed=!0,r.name=""),R(r.type,r.name)&&(r.name=""),r.type=b(r.type);let c=n(r.parent);r.parent.components.push(c),delete r.parent,r=c;break;case" ":r.state.allowType&&r.type!==""&&(r.type=b(r.type),delete r.state.allowType,r.state.allowName=!0,r.state.allowParams=!0),r.state.allowName&&r.name!==""&&(r.name==="indexed"?(e||s(o),r.indexed&&s(o),r.indexed=!0,r.name=""):R(r.type,r.name)?r.name="":r.state.allowName=!1);break;case"[":r.state.allowArray||s(o),r.type+=l,r.state.allowArray=!1,r.state.allowName=!1,r.state.readArray=!0;break;case"]":r.state.readArray||s(o),r.type+=l,r.state.readArray=!1,r.state.allowArray=!0,r.state.allowName=!0;break;default:r.state.allowType?(r.type+=l,r.state.allowParams=!0,r.state.allowArray=!0):r.state.allowName?(r.name+=l,delete r.state.allowArray):r.state.readArray?r.type+=l:s(o)}}return r.parent&&V.throwArgumentError("unexpected eof","param",i),delete a.state,r.name==="indexed"?(e||s(t.length-7),r.indexed&&s(t.length-7),r.indexed=!0,r.name=""):R(r.type,r.name)&&(r.name=""),a.type=b(a.type),a}function F(i,e){for(let t in e)y(i,t,e[t])}const p=Object.freeze({sighash:"sighash",minimal:"minimal",full:"full",json:"json"}),ae=new RegExp(/^(.*)\[([0-9]*)\]$/);class f{constructor(e,t){e!==W&&V.throwError("use fromString",d.errors.UNSUPPORTED_OPERATION,{operation:"new ParamType()"}),F(this,t);let s=this.type.match(ae);s?F(this,{arrayLength:parseInt(s[2]||"-1"),arrayChildren:f.fromObject({type:s[1],components:this.components}),baseType:"array"}):F(this,{arrayLength:null,arrayChildren:null,baseType:this.components!=null?"tuple":this.type}),this._isParamType=!0,Object.freeze(this)}format(e){if(e||(e=p.sighash),p[e]||V.throwArgumentError("invalid format type","format",e),e===p.json){let s={type:this.baseType==="tuple"?"tuple":this.type,name:this.name||void 0};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.components&&(s.components=this.components.map(n=>JSON.parse(n.format(e)))),JSON.stringify(s)}let t="";return this.baseType==="array"?(t+=this.arrayChildren.format(e),t+="["+(this.arrayLength<0?"":String(this.arrayLength))+"]"):this.baseType==="tuple"?(e!==p.sighash&&(t+=this.type),t+="("+this.components.map(s=>s.format(e)).join(e===p.full?", ":",")+")"):t+=this.type,e!==p.sighash&&(this.indexed===!0&&(t+=" indexed"),e===p.full&&this.name&&(t+=" "+this.name)),t}static from(e,t){return typeof e=="string"?f.fromString(e,t):f.fromObject(e)}static fromObject(e){return f.isParamType(e)?e:new f(W,{name:e.name||null,type:b(e.type),indexed:e.indexed==null?null:!!e.indexed,components:e.components?e.components.map(f.fromObject):null})}static fromString(e,t){function s(n){return f.fromObject({name:n.name,type:n.type,indexed:n.indexed,components:n.components})}return s(ne(e,!!t))}static isParamType(e){return!!(e!=null&&e._isParamType)}}function b(i){return i.match(/^uint($|[^1-9])/)?i="uint256"+i.substring(4):i.match(/^int($|[^1-9])/)&&(i="int256"+i.substring(3)),i}const $=new d(O);class g{constructor(e,t,s,n){this.name=e,this.type=t,this.localName=s,this.dynamic=n}_throwError(e,t){$.throwArgumentError(e,this.localName,t)}}class L{constructor(e){y(this,"wordSize",e||32),this._data=[],this._dataLength=0,this._padding=new Uint8Array(e)}get data(){return q(this._data)}get length(){return this._dataLength}_writeData(e){return this._data.push(e),this._dataLength+=e.length,e.length}appendWriter(e){return this._writeData(C(e._data))}writeBytes(e){let t=E(e);const s=t.length%this.wordSize;return s&&(t=C([t,this._padding.slice(s)])),this._writeData(t)}_getValue(e){let t=E(k.from(e));return t.length>this.wordSize&&$.throwError("value out-of-bounds",d.errors.BUFFER_OVERRUN,{length:this.wordSize,offset:t.length}),t.length%this.wordSize&&(t=C([this._padding.slice(t.length%this.wordSize),t])),t}writeValue(e){return this._writeData(this._getValue(e))}writeUpdatableValue(){const e=this._data.length;return this._data.push(this._padding),this._dataLength+=this.wordSize,t=>{this._data[e]=this._getValue(t)}}}class z{constructor(e,t,s,n){y(this,"_data",E(e)),y(this,"wordSize",t||32),y(this,"_coerceFunc",s),y(this,"allowLoose",n),this._offset=0}get data(){return U(this._data)}get consumed(){return this._offset}static coerce(e,t){let s=e.match("^u?int([0-9]+)$");return s&&parseInt(s[1])<=48&&(t=t.toNumber()),t}coerce(e,t){return this._coerceFunc?this._coerceFunc(e,t):z.coerce(e,t)}_peekBytes(e,t,s){let n=Math.ceil(t/this.wordSize)*this.wordSize;return this._offset+n>this._data.length&&(this.allowLoose&&s&&this._offset+t<=this._data.length?n=t:$.throwError("data out-of-bounds",d.errors.BUFFER_OVERRUN,{length:this._data.length,offset:this._offset+n})),this._data.slice(this._offset,this._offset+n)}subReader(e){return new z(this._data.slice(this._offset+e),this.wordSize,this._coerceFunc,this.allowLoose)}readBytes(e,t){let s=this._peekBytes(0,e,!!t);return this._offset+=s.length,s.slice(0,e)}readValue(){return k.from(this.readBytes(this.wordSize))}}class ie extends g{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){try{t=j(t)}catch(s){this._throwError(s.message,t)}return e.writeValue(t)}decode(e){return j(Z(e.readValue().toHexString(),20))}}class oe extends g{constructor(e){super(e.name,e.type,void 0,e.dynamic),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,t){return this.coder.encode(e,t)}decode(e){return this.coder.decode(e)}}const x=new d(O);function v(i,e,t){let s=null;if(Array.isArray(t))s=t;else if(t&&typeof t=="object"){let l={};s=e.map(u=>{const c=u.localName;return c||x.throwError("cannot encode object for signature with missing names",d.errors.INVALID_ARGUMENT,{argument:"values",coder:u,value:t}),l[c]&&x.throwError("cannot encode object for signature with duplicate names",d.errors.INVALID_ARGUMENT,{argument:"values",coder:u,value:t}),l[c]=!0,t[c]})}else x.throwArgumentError("invalid tuple value","tuple",t);e.length!==s.length&&x.throwArgumentError("types/value length mismatch","tuple",t);let n=new L(i.wordSize),a=new L(i.wordSize),r=[];e.forEach((l,u)=>{let c=s[u];if(l.dynamic){let w=a.length;l.encode(a,c);let _=n.writeUpdatableValue();r.push(N=>{_(N+w)})}else l.encode(n,c)}),r.forEach(l=>{l(n.length)});let o=i.appendWriter(n);return o+=i.appendWriter(a),o}function G(i,e){let t=[],s=i.subReader(0);e.forEach(a=>{let r=null;if(a.dynamic){let o=i.readValue(),l=s.subReader(o.toNumber());try{r=a.decode(l)}catch(u){if(u.code===d.errors.BUFFER_OVERRUN)throw u;r=u,r.baseType=a.name,r.name=a.localName,r.type=a.type}}else try{r=a.decode(i)}catch(o){if(o.code===d.errors.BUFFER_OVERRUN)throw o;r=o,r.baseType=a.name,r.name=a.localName,r.type=a.type}r!=null&&t.push(r)});const n=e.reduce((a,r)=>{const o=r.localName;return o&&(a[o]||(a[o]=0),a[o]++),a},{});e.forEach((a,r)=>{let o=a.localName;if(!o||n[o]!==1||(o==="length"&&(o="_length"),t[o]!=null))return;const l=t[r];l instanceof Error?Object.defineProperty(t,o,{enumerable:!0,get:()=>{throw l}}):t[o]=l});for(let a=0;a<t.length;a++){const r=t[a];r instanceof Error&&Object.defineProperty(t,a,{enumerable:!0,get:()=>{throw r}})}return Object.freeze(t)}class le extends g{constructor(e,t,s){const n=e.type+"["+(t>=0?t:"")+"]",a=t===-1||e.dynamic;super("array",n,s,a),this.coder=e,this.length=t}defaultValue(){const e=this.coder.defaultValue(),t=[];for(let s=0;s<this.length;s++)t.push(e);return t}encode(e,t){Array.isArray(t)||this._throwError("expected array value",t);let s=this.length;s===-1&&(s=t.length,e.writeValue(t.length)),x.checkArgumentCount(t.length,s,"coder array"+(this.localName?" "+this.localName:""));let n=[];for(let a=0;a<t.length;a++)n.push(this.coder);return v(e,n,t)}decode(e){let t=this.length;t===-1&&(t=e.readValue().toNumber(),t*32>e._data.length&&x.throwError("insufficient data length",d.errors.BUFFER_OVERRUN,{length:e._data.length,count:t}));let s=[];for(let n=0;n<t;n++)s.push(new oe(this.coder));return e.coerce(this.name,G(e,s))}}class ce extends g{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){return e.writeValue(t?1:0)}decode(e){return e.coerce(this.type,!e.readValue().isZero())}}class M extends g{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=E(t);let s=e.writeValue(t.length);return s+=e.writeBytes(t),s}decode(e){return e.readBytes(e.readValue().toNumber(),!0)}}class ue extends M{constructor(e){super("bytes",e)}decode(e){return e.coerce(this.name,U(super.decode(e)))}}class de extends g{constructor(e,t){let s="bytes"+String(e);super(s,s,t,!1),this.size=e}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(e,t){let s=E(t);return s.length!==this.size&&this._throwError("incorrect data length",t),e.writeBytes(s)}decode(e){return e.coerce(this.name,U(e.readBytes(this.size)))}}class he extends g{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes([])}decode(e){return e.readBytes(0),e.coerce(this.name,null)}}class fe extends g{constructor(e,t,s){const n=(t?"int":"uint")+e*8;super(n,n,s,!1),this.size=e,this.signed=t}defaultValue(){return 0}encode(e,t){let s=k.from(t),n=H.mask(e.wordSize*8);if(this.signed){let a=n.mask(this.size*8-1);(s.gt(a)||s.lt(a.add(K).mul(Q)))&&this._throwError("value out-of-bounds",t)}else(s.lt(X)||s.gt(n.mask(this.size*8)))&&this._throwError("value out-of-bounds",t);return s=s.toTwos(this.size*8).mask(this.size*8),this.signed&&(s=s.fromTwos(this.size*8).toTwos(8*e.wordSize)),e.writeValue(s)}decode(e){let t=e.readValue().mask(this.size*8);return this.signed&&(t=t.fromTwos(this.size*8)),e.coerce(this.name,t)}}class ge extends M{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Y(t))}decode(e){return ee(super.decode(e))}}class A extends g{constructor(e,t){let s=!1;const n=[];e.forEach(r=>{r.dynamic&&(s=!0),n.push(r.type)});const a="tuple("+n.join(",")+")";super("tuple",a,t,s),this.coders=e}defaultValue(){const e=[];this.coders.forEach(s=>{e.push(s.defaultValue())});const t=this.coders.reduce((s,n)=>{const a=n.localName;return a&&(s[a]||(s[a]=0),s[a]++),s},{});return this.coders.forEach((s,n)=>{let a=s.localName;!a||t[a]!==1||(a==="length"&&(a="_length"),e[a]==null&&(e[a]=e[n]))}),Object.freeze(e)}encode(e,t){return v(e,this.coders,t)}decode(e){return e.coerce(this.name,G(e,this.coders))}}const S=new d(O),pe=new RegExp(/^bytes([0-9]*)$/),me=new RegExp(/^(u?int)([0-9]*)$/);class J{constructor(e){y(this,"coerceFunc",e||null)}_getCoder(e){switch(e.baseType){case"address":return new ie(e.name);case"bool":return new ce(e.name);case"string":return new ge(e.name);case"bytes":return new ue(e.name);case"array":return new le(this._getCoder(e.arrayChildren),e.arrayLength,e.name);case"tuple":return new A((e.components||[]).map(s=>this._getCoder(s)),e.name);case"":return new he(e.name)}let t=e.type.match(me);if(t){let s=parseInt(t[2]||"256");return(s===0||s>256||s%8!==0)&&S.throwArgumentError("invalid "+t[1]+" bit length","param",e),new fe(s/8,t[1]==="int",e.name)}if(t=e.type.match(pe),t){let s=parseInt(t[1]);return(s===0||s>32)&&S.throwArgumentError("invalid bytes length","param",e),new de(s,e.name)}return S.throwArgumentError("invalid type","type",e.type)}_getWordSize(){return 32}_getReader(e,t){return new z(e,this._getWordSize(),this.coerceFunc,t)}_getWriter(){return new L(this._getWordSize())}getDefaultValue(e){const t=e.map(n=>this._getCoder(f.from(n)));return new A(t,"_").defaultValue()}encode(e,t){e.length!==t.length&&S.throwError("types/values length mismatch",d.errors.INVALID_ARGUMENT,{count:{types:e.length,values:t.length},value:{types:e,values:t}});const s=e.map(r=>this._getCoder(f.from(r))),n=new A(s,"_"),a=this._getWriter();return n.encode(a,t),a.data}decode(e,t,s){const n=e.map(r=>this._getCoder(f.from(r)));return new A(n,"_").decode(this._getReader(E(t),s))}}new J;const m=typeof window<"u"&&window.browser?window.browser:chrome,ye=["https://sepolia.gateway.tenderly.co","https://ethereum-sepolia.publicnode.com","https://rpc.sepolia.org","https://sepolia.infura.io/v3/9aa3d95b3bc440fa88ea12eaa4456161"],I=new J;function B(i){if(!i||typeof i!="string")return null;if(i.startsWith("{"))try{const t=JSON.parse(i);return B(t==null?void 0:t.data)}catch{return null}const e=i.startsWith("0x")?i:`0x${i}`;if(e==="0x"||e.length<10)return null;if(e.slice(0,10)==="0x08c379a0")try{const[t]=I.decode(["string"],`0x${e.slice(10)}`);return t}catch{return null}if(e.slice(0,10)==="0x4e487b71")try{const[t]=I.decode(["uint256"],`0x${e.slice(10)}`);return`Panic code 0x${t.toHexString().slice(2).padStart(4,"0")}`}catch{return"Solidity panic"}return null}window.addEventListener("load",async()=>{const i=async()=>{var s;const t=await m.storage.local.get(["pendingSignerTransaction"]);if(t.pendingSignerTransaction){const{transaction:n,privateKey:a,requestId:r}=t.pendingSignerTransaction;await m.storage.local.remove(["pendingSignerTransaction"]);try{for(const o of ye)try{const l=new te(o),u=new re(a,l),c={to:n.to,value:n.value||"0x0",data:n.data||"0x"};(n.gas||n.gasLimit)&&(c.gasLimit=n.gas||n.gasLimit),n.gasPrice?c.gasPrice=n.gasPrice:n.maxFeePerGas&&(c.maxFeePerGas=n.maxFeePerGas,n.maxPriorityFeePerGas&&(c.maxPriorityFeePerGas=n.maxPriorityFeePerGas));const w=await u.sendTransaction(c);let _;try{_=await l.waitForTransaction(w.hash,1,6e4)}catch{}if(!_){await m.storage.local.set({[`signerResult_${r}`]:{success:!0,hash:w.hash,pending:!0}}),window.close();return}if(_.status===1){await m.storage.local.set({[`signerResult_${r}`]:{success:!0,hash:w.hash}}),window.close();return}let N="Transaction reverted on-chain. Please review the contract logic or see the explorer for details.";try{const h={to:c.to,data:c.data,from:u.address,value:c.value,gasLimit:c.gasLimit},P=await l.call(h,_.blockNumber),T=B(P);T&&(N=`Transaction reverted: ${T}`)}catch(h){const P=((s=h==null?void 0:h.error)==null?void 0:s.data)||(h==null?void 0:h.data)||(h==null?void 0:h.body),T=B(P);T&&(N=`Transaction reverted: ${T}`)}await m.storage.local.set({[`signerResult_${r}`]:{success:!1,hash:w.hash,error:N}}),window.close();return}catch{continue}await m.storage.local.set({[`signerResult_${r}`]:{success:!1,error:"All RPC endpoints failed to send transaction"}}),window.close()}catch(o){await m.storage.local.set({[`signerResult_${r}`]:{success:!1,error:o.message}}),window.close()}}};i();const e=setInterval(i,100);setTimeout(()=>{clearInterval(e),window.close()},3e4)});
